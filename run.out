{"pid": 63783, "host": "zkbitcoin.com", "port": "3000", "secure": true, "event": "\ud83e\udd88  ready", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:25:16.721038Z"}
{"pid": 63783, "event": "unhandled event processing exception", "level": "error", "logger": "socketshark", "timestamp": "2021-11-06T12:25:46.320346Z", "exception": "Traceback (most recent call last):\n  File \"/home/pivx/python/src/socketshark/socketshark/session.py\", line 43, in on_client_event\n    result = await event.full_process()\n  File \"/home/pivx/python/src/socketshark/socketshark/events.py\", line 68, in full_process\n    return await self.process()\n  File \"/home/pivx/python/src/socketshark/socketshark/events.py\", line 154, in process\n    await self.subscription.subscribe(self)\n  File \"/home/pivx/python/src/socketshark/socketshark/subscription.py\", line 329, in subscribe\n    await event.send_ok(result.get('data'))\n  File \"/home/pivx/python/src/socketshark/socketshark/events.py\", line 142, in send_ok\n    await super().send_ok(data=data, extra_data={\n  File \"/home/pivx/python/src/socketshark/socketshark/events.py\", line 61, in send_ok\n    await self.session.send(msg)\n  File \"/home/pivx/python/src/socketshark/socketshark/session.py\", line 106, in send\n    await self.client.send(data)\n  File \"/home/pivx/python/src/socketshark/socketshark/backend/websockets.py\", line 85, in send\n    await self.websocket.send(json.dumps(event))\n  File \"/home/pivx/python/src/socketshark/.venv/lib/python3.9/site-packages/websockets/protocol.py\", line 371, in send\n    yield from self.write_frame(opcode, data)\n  File \"/home/pivx/python/src/socketshark/.venv/lib/python3.9/site-packages/websockets/protocol.py\", line 740, in write_frame\n    with (yield from self._drain_lock):\nTypeError: 'Lock' object is not iterable"}
{"pid": 63783, "session": 140250101860144, "event": "unhandled error in consumer handler", "level": "error", "logger": "socketshark", "timestamp": "2021-11-06T12:25:46.321763Z", "exception": "Traceback (most recent call last):\n  File \"/home/pivx/python/src/socketshark/socketshark/session.py\", line 43, in on_client_event\n    result = await event.full_process()\n  File \"/home/pivx/python/src/socketshark/socketshark/events.py\", line 68, in full_process\n    return await self.process()\n  File \"/home/pivx/python/src/socketshark/socketshark/events.py\", line 154, in process\n    await self.subscription.subscribe(self)\n  File \"/home/pivx/python/src/socketshark/socketshark/subscription.py\", line 329, in subscribe\n    await event.send_ok(result.get('data'))\n  File \"/home/pivx/python/src/socketshark/socketshark/events.py\", line 142, in send_ok\n    await super().send_ok(data=data, extra_data={\n  File \"/home/pivx/python/src/socketshark/socketshark/events.py\", line 61, in send_ok\n    await self.session.send(msg)\n  File \"/home/pivx/python/src/socketshark/socketshark/session.py\", line 106, in send\n    await self.client.send(data)\n  File \"/home/pivx/python/src/socketshark/socketshark/backend/websockets.py\", line 85, in send\n    await self.websocket.send(json.dumps(event))\n  File \"/home/pivx/python/src/socketshark/.venv/lib/python3.9/site-packages/websockets/protocol.py\", line 371, in send\n    yield from self.write_frame(opcode, data)\n  File \"/home/pivx/python/src/socketshark/.venv/lib/python3.9/site-packages/websockets/protocol.py\", line 740, in write_frame\n    with (yield from self._drain_lock):\nTypeError: 'Lock' object is not iterable\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/pivx/python/src/socketshark/socketshark/backend/websockets.py\", line 75, in consumer_handler\n    await self.session.on_client_event(data)\n  File \"/home/pivx/python/src/socketshark/socketshark/session.py\", line 55, in on_client_event\n    await event.send_error(c.ERR_UNHANDLED_EXCEPTION)\n  File \"/home/pivx/python/src/socketshark/socketshark/events.py\", line 137, in send_error\n    await super().send_error(error, data=data, extra_data={\n  File \"/home/pivx/python/src/socketshark/socketshark/events.py\", line 50, in send_error\n    await self.session.send(msg)\n  File \"/home/pivx/python/src/socketshark/socketshark/session.py\", line 106, in send\n    await self.client.send(data)\n  File \"/home/pivx/python/src/socketshark/socketshark/backend/websockets.py\", line 85, in send\n    await self.websocket.send(json.dumps(event))\n  File \"/home/pivx/python/src/socketshark/.venv/lib/python3.9/site-packages/websockets/protocol.py\", line 371, in send\n    yield from self.write_frame(opcode, data)\n  File \"/home/pivx/python/src/socketshark/.venv/lib/python3.9/site-packages/websockets/protocol.py\", line 740, in write_frame\n    with (yield from self._drain_lock):\nTypeError: 'Lock' object is not iterable"}
Error in closing handshake
Traceback (most recent call last):
  File "/home/pivx/python/src/socketshark/.venv/lib/python3.9/site-packages/websockets/server.py", line 164, in handler
    yield from self.close()
  File "/home/pivx/python/src/socketshark/.venv/lib/python3.9/site-packages/websockets/protocol.py", line 391, in close
    yield from asyncio.wait_for(
  File "/usr/lib/python3.9/asyncio/tasks.py", line 481, in wait_for
    return fut.result()
  File "/home/pivx/python/src/socketshark/.venv/lib/python3.9/site-packages/websockets/protocol.py", line 786, in write_close_frame
    yield from self.write_frame(OP_CLOSE, data, State.CLOSING)
  File "/home/pivx/python/src/socketshark/.venv/lib/python3.9/site-packages/websockets/protocol.py", line 740, in write_frame
    with (yield from self._drain_lock):
TypeError: 'Lock' object is not iterable
Error in data transfer
Traceback (most recent call last):
  File "/home/pivx/python/src/socketshark/.venv/lib/python3.9/site-packages/websockets/protocol.py", line 528, in transfer_data
    msg = yield from self.read_message()
  File "/home/pivx/python/src/socketshark/.venv/lib/python3.9/site-packages/websockets/protocol.py", line 580, in read_message
    frame = yield from self.read_data_frame(max_size=self.max_size)
  File "/home/pivx/python/src/socketshark/.venv/lib/python3.9/site-packages/websockets/protocol.py", line 645, in read_data_frame
    frame = yield from self.read_frame(max_size)
  File "/home/pivx/python/src/socketshark/.venv/lib/python3.9/site-packages/websockets/protocol.py", line 706, in read_frame
    frame = yield from Frame.read(
  File "/home/pivx/python/src/socketshark/.venv/lib/python3.9/site-packages/websockets/framing.py", line 100, in read
    data = yield from reader(2)
  File "/usr/lib/python3.9/asyncio/streams.py", line 723, in readexactly
    await self._wait_for_data('readexactly')
  File "/usr/lib/python3.9/asyncio/streams.py", line 517, in _wait_for_data
    await self._waiter
  File "/usr/lib/python3.9/asyncio/sslproto.py", line 528, in data_received
    ssldata, appdata = self._sslpipe.feed_ssldata(data)
  File "/usr/lib/python3.9/asyncio/sslproto.py", line 206, in feed_ssldata
    self._sslobj.unwrap()
  File "/usr/lib/python3.9/ssl.py", line 948, in unwrap
    return self._sslobj.shutdown()
ssl.SSLError: [SSL: APPLICATION_DATA_AFTER_CLOSE_NOTIFY] application data after close notify (_ssl.c:2756)
{"pid": 63783, "event": "stop requested", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:04.931471Z"}
{"pid": 63783, "event": "shutting down", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:04.936300Z"}
{"pid": 63783, "session": 140250101860144, "event": "closing connection", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:04.939403Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:04.950662Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:05.952290Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:06.953778Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:07.956354Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:08.957715Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:09.959370Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:10.961050Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:11.962800Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:13.289332Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:14.290715Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:15.294470Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:16.296508Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:17.302154Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:18.304245Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:19.305853Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:20.306988Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:21.308724Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:22.310598Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:23.312160Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:24.313776Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:25.315430Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:26.317001Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:27.318697Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:28.320250Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:29.321717Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:30.323476Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:31.325183Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:32.326745Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:33.328710Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:34.329955Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:35.331549Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:36.333216Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:37.334137Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:38.335677Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:39.337625Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:40.339241Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:41.341015Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:42.341851Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:43.343445Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:44.345035Z"}
{"pid": 63783, "n_sessions": 1, "event": "waiting for sessions to close", "level": "info", "logger": "socketshark", "timestamp": "2021-11-06T12:36:45.346639Z"}
